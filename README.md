# WeavingMacro
このツールは、織物用の組織図と配色図を作るもの、および組織図から綜絖の通し方図と踏み方図を作るものです。
Microsoft Excel VBAで稼働します。

「組織図・配色図へ」シートで、綜絖とタイアップと踏み木を黒くして[組織図]をクリックすると組織図が作成されます。  
更に、経糸と緯糸に使用する色を指定して[配色図]をクリックすると配色図が作成されます。

「組織図から」シートで、組織図の組織点とタイアップを黒くして[実行]をクリックすると、綜絖の通し方図と踏み方図が生成されます。

## Requirement
- Microsoft Windows
- Microsoft Excel

### 動作確認済の環境
- Windows 8.1 + Excel 2013
- Windows 10 + Excel 2000
- Windows 10 + Excel 2010
- Windows 10 + Excel 2013
- Windows 10 + Excel 2016
- MacOS Mojave 10.14.6 + Excel for Mac 2019

他の環境でも動いたら、ここに追記しますので、commitへのコメントなどでご一報いただけると有難いです。
2020/3/8にMacOS Mojaveでの動作報告をいただいたので追加しました。


なお、LibreOfficeで動くものを、odsフォルダ以下に置きました。   
LibreOffice版なら、Mac OSでも動くのではないかと期待しています。  
但し、LibreOffice版は、フォントサイズや配色図での罫線において不具合があります。  
また、LibreOffice版は、組織図から綜絖の通し方図と踏み方図を持つ機能はありません。


## Thanks

Gitでソースコード管理をするため、igetaさんのAriawase(vbac.wsf)を使用して、VBAのエクスポート・インポートをしています。
Ariawaseのライセンスは以下の通りです。  
https://github.com/vbaidiot/Ariawase#license


## Setup
「Code」から「Download ZIP」をクリックしてZIPファイルをDL後解凍してください。  
binフォルダ内にxlsmファイルが入っています。

以前まで入っていた古いExcel用のxlsファイルは現在入っていません。TagsからV3.9.2を選ぶと、
その中にはxlsファイル(V3.8.x)を入れてあるので、どうしてもという場合にはそちらをご利用ください。  
但し、基本的にメンテナンスはしません。V3.8.xですので、組織図から綜絖の通し方図と踏み方図を持つ機能はありません。

## Usage

### 「組織図・配色図へ」シート

#### 1.初期化
踏み木本数と、綜絖枚数と、タイアップ部分をどの位置にするかと、図の幅・図の高さを入力して[初期化]ボタンをクリックして、マス目を作ります。

#### 2.準備
踏むと綜絖が上がるか下がるかを「↑」と「↓」から選びます。  
以下の図のように、綜絖とタイアップと踏み木を黒くします。  
![to1](https://user-images.githubusercontent.com/47298391/111017049-8a457a00-83f4-11eb-85b0-889dc16f73af.png)  

#### 3.組織図
「組織図」ボタンをクリックすると   
![to2](https://user-images.githubusercontent.com/47298391/111017052-90d3f180-83f4-11eb-8f0a-32eb1f9501a7.png)  
こんな風に、どんな組織になるかが表示されます。

#### 4.配色図
以下の図のように、色を指定して、  
![to3](https://user-images.githubusercontent.com/47298391/111017055-93cee200-83f4-11eb-8c12-83e81321c39c.png)

「配色図」ボタンをクリックすると   
![to4](https://user-images.githubusercontent.com/47298391/111017061-96313c00-83f4-11eb-825b-f6dd59a4200c.png)  
こんな風に、どんな配色になるのかが表示されます。

### 「組織図から」シート

#### 1.初期化
踏み木本数と、綜絖枚数と、タイアップ部分をどの位置にするかと、図の幅・図の高さを入力して[初期化]ボタンをクリックして、マス目を作ります。

#### 2.準備
踏むと綜絖が上がるか下がるかを「↑」と「↓」から選びます。  
以下の図のように、組織図を黒くします。なお、綜絖と踏み木を１：１で結ぶ場合は、タイアップを先に黒くしてください。  
![from1](https://user-images.githubusercontent.com/47298391/117091797-5f91f500-ad97-11eb-84d2-5f85bc9df126.png)

#### 3. 実行
「実行」ボタンをクリックすると  
![from2](https://user-images.githubusercontent.com/47298391/111017067-9a5d5980-83f4-11eb-84e7-5357b4e9c608.png)  
こんな風に、綜絖の通し方図と踏み木の踏み方図が表示されます。

### お願い
簡単なテストはしていますが、実際に使ってみると不具合が生じるかもしれません。その際はIssuesへの書き込み・その他の連絡手段でご連絡下さい。
可能な範囲で修正したいと思います。  
要望などもIssuesでお知らせください。検討します。

### 仕様
綜絖の通し方は、右上が黒くなる仕様です。
したがって書籍などの組織図で右上が黒くない（例えば一番右は三番目が黒いなど）もので試した場合、書籍と違う通し方・踏み方で表示されますが、それは間違いではありません。



## Licence
This software is released under the Mozilla Public License 2.0, see LICENSE.

Mozilla Public License 2.0の下、使用にあたっては制限はありません。  
改変や第三者への配布を行う場合に、制限が生じます。詳細はLICENCEをご確認ください。  
また、出版物に載せるなどの場合はcommitにコメントをつけるなどでご一報ください。

なお、個人が生成した図を画像にしてサイトに載せる場合はご連絡くださらなくてけっこうです。
ただし、本に載っていたものから完全意匠図を作成した場合、マクロではなく、その本の著作権に抵触しないか、十分お気を付けください。

## Authors

[Riko](https://github.com/riko122)

## History

- 2021/ 5/ 5 V4.1.0 組織図から変更する機能で、複式タイアップの場合、事前にタイアップを書かないように変更
- 2021/ 3/13 V4.0.1 マクロの内部的な処理変更
- 2021/ 3/13 V4.0.0 組織図から変換する機能を追加
- 2021/ 1/ 7 V3.9.2 印刷時のフッターをコピーライト表記からURLに変更
- 2021/ 1/ 6 V3.9.1 コピーライトを追記
- 2020/ 7/12 V3.9   ファイル形式をxlsmで保存
- 2020/ 7/12 V3.8.2 「緯糸の色↓」の矢印が下を向くように修正
- 2019/ 5/ 3 LibreOffice版のV3.8.2oもGitHubでの管理下に追加
- 2019/ 5/ 1 V3.8.1 マクロの内部的な処理変更
- 2019/ 4/20 V3.8   「↑又は↓」を選ぶセルの位置の変更
- 2019/ 2/ 5 V3.7.1 よりGitHubでの管理開始
